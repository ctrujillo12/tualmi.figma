---
import '../styles/global.css';
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Shopping Cart | Tualmi</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Cormorant:wght@300;400;500&family=Inter:wght@300;400;500&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <nav class="nav">
      <a href="/"><img src="/images/logo.png" alt="Tualmi" class="logo" /></a>
      <div class="nav-links">
        <a href="/#collection">COLLECTION</a>
        <a href="/#about">ABOUT</a>
        <a href="/cart">CART<span id="cartCount" style="display: none;"></span></a>
      </div>
    </nav>

    <main class="container cart-page">
      <h1 class="cart-title">Shopping Cart</h1>

      <div id="emptyCart" class="empty-cart-msg" style="display: none;">
        Your cart is empty. <a href="/#collection" style="color: var(--chocolate); text-decoration: underline;">Continue shopping</a>
      </div>

      <div id="cartContent" style="display: none;">
        <div id="cartItems" class="cart-container">
          <!-- Cart items will be inserted here by JavaScript -->
        </div>

        <div class="cart-summary">
          <div class="summary-content">
            <div class="total-row">
              <span class="total-label">Total</span>
              <span id="cartTotal" class="total-price">$0.00</span>
            </div>
            <button id="clearCart" class="clear-btn">Clear Cart</button>
            <a href="/checkout" class="checkout-btn">Proceed to Checkout</a>
          </div>
        </div>
      </div>
    </main>

    <footer class="footer">
      <div class="footer-content">
        <div class="footer-grid">
          <div class="footer-section">
            <h3 class="footer-title">Tualmi</h3>
            <p class="footer-text">Sustainable fashion for the modern woman.</p>
          </div>
          <div class="footer-section">
            <h3 class="footer-title">Shop</h3>
            <p class="footer-text">Browse our collection of ethically crafted pieces.</p>
          </div>
          <div class="footer-section">
            <h3 class="footer-title">About</h3>
            <p class="footer-text">Learn about our commitment to sustainability.</p>
          </div>
          <div class="footer-section">
            <h3 class="footer-title">Contact</h3>
            <p class="footer-text">Get in touch with our team.</p>
          </div>
        </div>
        <div class="footer-bottom">
          <p class="footer-tagline">Adventure meets elegance</p>
          <p class="footer-copyright">Â© 2025 Tualmi. All rights reserved.</p>
        </div>
      </div>
    </footer>

    <!-- Scripts -->
    <script src="/scripts/cart-manager.js" is:inline></script>
    <script is:inline>
      // Cart page functionality
      document.addEventListener('DOMContentLoaded', () => {
        const cartManager = window.cartManager;
        const cartItemsContainer = document.getElementById('cartItems');
        const cartTotalEl = document.getElementById('cartTotal');
        const emptyCartEl = document.getElementById('emptyCart');
        const cartContentEl = document.getElementById('cartContent');
        const clearCartBtn = document.getElementById('clearCart');

        function renderCart() {
          const cart = cartManager.getCart();
          
          if (cart.length === 0) {
            emptyCartEl.style.display = 'block';
            cartContentEl.style.display = 'none';
            return;
          }

          emptyCartEl.style.display = 'none';
          cartContentEl.style.display = 'block';

          cartItemsContainer.innerHTML = cart.map((item, index) => `
            <div class="cart-item">
              <div class="cart-item-image">
                <img src="${item.image}" alt="${item.name}" />
              </div>
              <div class="cart-item-details">
                <h3 class="cart-item-name">${item.name}</h3>
                <p class="cart-item-meta">Color: ${item.color} | Size: ${item.size}</p>
                <p class="cart-item-price">$${item.price.toFixed(2)}</p>
              </div>
              <div class="cart-item-actions">
                <div class="qty-controls">
                  <label for="qty-${index}">QTY</label>
                  <input 
                    type="number" 
                    id="qty-${index}" 
                    class="cart-qty" 
                    value="${item.quantity}" 
                    min="1" 
                    max="10"
                    data-index="${index}"
                  />
                </div>
                <p class="cart-item-total">$${(item.price * item.quantity).toFixed(2)}</p>
                <button class="remove-btn" data-index="${index}">Remove</button>
              </div>
            </div>
          `).join('');

          // Update total
          const total = cartManager.getTotal();
          cartTotalEl.textContent = `$${total.toFixed(2)}`;

          // Add event listeners
          attachEventListeners();
        }

        function attachEventListeners() {
          // Quantity changes
          document.querySelectorAll('.cart-qty').forEach(input => {
            input.addEventListener('change', (e) => {
              const index = parseInt(e.target.dataset.index);
              const newQty = parseInt(e.target.value);
              cartManager.updateQuantity(index, newQty);
              renderCart();
            });
          });

          // Remove buttons
          document.querySelectorAll('.remove-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
              const index = parseInt(e.target.dataset.index);
              if (confirm('Remove this item from your cart?')) {
                cartManager.removeItem(index);
                renderCart();
              }
            });
          });
        }

        // Clear cart button
        clearCartBtn.addEventListener('click', () => {
          if (confirm('Are you sure you want to clear your entire cart?')) {
            cartManager.clearCart();
            renderCart();
          }
        });

        // Initial render
        renderCart();
      });
    </script>
  </body>
</html>